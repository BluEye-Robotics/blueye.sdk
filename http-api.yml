openapi: '3.0.2'
info:
  title: Blueye HTTP API
  version: '1.0.0'
servers:
  - url: http://192.168.1.101/

paths:
  /diagnostics/drone_info:
    get:
      summary: Drone information
      description: |
        Returns a JSON string of drone information. Using this endpoint is the easiest way to check
        if there is a drone connected to your network.
      responses:
        '200':
          description: A JSON string of drone information.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DroneInfo'
      x-code-samples:
        - lang: "curl"
          source: |
            curl -X GET "http://192.168.1.101/diagnostics/drone_info"

        - lang: "Python"
          source: |
            import requests
            response = requests.get("http://192.168.1.101/diagnostics/drone_info")
            print(response.json())

  /logcsv:
    get:
      summary: Array of logs
      description: |
        Returns an array of logs from the drone. Each array item represents an available log file on
        the drone. Use the /logcsv/{filename} endpoint to get the full log.

      responses:
        '200':
          description: Array of logs
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Log'

  /logcsv/{filename}:
    get:
      summary: CSV log-file
      description: Downloads a comma-separated-value (CSV) log-file with the requested name.
      parameters:
        - name: filename
          in: path
          description: Filename of log to download
          required: true
          schema:
            type: string
      responses:
        '200':
          description: Comma-separated-value file with log data
          content:
            text/csv:
              schema:
                type: string

components:
  schemas:
    DroneInfo:
      type: object
      properties:
        commit_id_csys:
          type: string
        features:
          type: string
        hardware_id:
          type: string
        manufacturer:
          type: string
        model_description:
          type: string
        model_name:
          type: string
        model_url:
          type: string
        operating_system:
          type: string
        serial_number:
          type: string
        sw_version:
          type: string

    Log:
      type: object
      properties:
        name:
          type: string
          description: |
            Name of the logfile. First part is the drones unique id, second part is the dive count.
          example: ea9ac92e1817a1d4-00073.csv
        binsize:
          type: integer
          description: Size of the log file. Unit is bytes.
          example: 1099448
        timestamp:
          type: string
          description: Start time of the dive. Unit is ISO8601 datetime without timezone data.
          example: "2019-01-01T00:00:00.000001"
        maxdepth:
          type: number
          format: float
          description: Maximum depth reached during the dive. Unit is millimeters.
          example: 21050
